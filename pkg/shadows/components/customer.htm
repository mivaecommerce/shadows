<Page_Update code="OCST"><Item code="customer"><Template><![CDATA[<mvt:item name="readytheme" param="contentsection( 'checkout_steps' )" />

<mvt:if expr="l.settings:PaypalExButton:ExpressCheckoutToken">
	<mvt:comment>
		<!-- If you are using PayPal Express Checkout, having the log in will disrupt this process! -->
	</mvt:comment>
	<p class="x-messages x-messages--info">To continue with your PayPal checkout, enter any required information below and click on "Continue to Shipping".</p>
<mvt:else>
	<mvt:if expr="g.Basket:cust_id EQ 0">
		<div class="x-messages t-ocst-account-message x-collapsible-content">
			Already have an account? <button class="c-button c-button--clear u-color-black u-text-bold" data-a11y-toggle="checkoutLogIn" title="Click Here to Log Into Your Account">Click here to log in</button> or you can continue as a guest.
			<form id="checkoutLogIn" class="t-checkout-log-in__form x-collapsible-content__item" method="post" action="&mvte:urls:CACT:secure;" autocomplete="off">
				<fieldset>
					<legend>&mvt:page:name;</legend>
					<input type="hidden" name="current_location" value="&mvte:urls:OINF:secure_sep;">
					<input type="hidden" name="Order" value="&mvte:global:Order;">
					<div class="o-layout u-grids-1 u-grids-3--s">
						<div class="o-layout__item">
							<label class="u-hide-visually" for="register_email">Add Promo Code</label>
							<input id="register_email" class="c-form-input c-form-input--large c-control-group__field" type="text" inputmode="email" name="register_email" value="&mvte:global:register_email;" autocomplete="email" placeholder="Email" required>
						</div>
						<div class="o-layout__item">
							<label class="u-hide-visually" for="register_password">Add Promo Code</label>
							<input id="register_password" class="c-form-input c-form-input--large" type="password" name="register_password" autocomplete="current-password" placeholder="Password" required>
						</div>
						<div class="o-layout__item">
							<input class="c-button c-button--full c-button--huge u-bg-gray-50 u-font-small u-text-bold u-text-uppercase" type="submit" value="Log In">
						</div>
					</div>
				</fieldset>
			</form>
	
		</div>
		<hr class="c-keyline">
	<mvt:else>
		<p class="u-text-center"><span class="c-heading-echo u-text-bold">Welcome! You're logged in as &mvte:global:customer:ship_fname; &mvte:global:customer:ship_lname;.</span> Not you? <a href="&mvte:urls:OCST:secure_sep;Action=LOGO">Logout</a>.</p>
		<hr class="c-keyline">
	</mvt:if>
</mvt:if>

<mvt:item name="readytheme" param="contentsection( 'paypalcp_configuration' )" />

<mvt:item name="customfields" param="Read_Basket('basket', g.saved_fields)" />
<mvt:if expr="NOT ISNULL g.saved_fields" >
	<mvt:assign name="g.ShipFirstName" value="g.saved_fields:ship_fname" />
	<mvt:assign name="g.ShipLastName" value="g.saved_fields:ship_lname" />
	<mvt:assign name="g.ShipEmail" value="g.saved_fields:ship_email" />
	<mvt:assign name="g.ShipCompany" value="g.saved_fields:ship_comp" />
	<mvt:assign name="g.ShipPhone" value="g.saved_fields:ship_phone" />
	<mvt:assign name="g.ShipFax" value="g.saved_fields:ship_fax" />
	<mvt:assign name="g.ShipAddress1" value="g.saved_fields:ship_addr1" />
	<mvt:assign name="g.ShipAddress2" value="g.saved_fields:ship_addr2" />
	<mvt:assign name="g.ShipCity" value="g.saved_fields:ship_city" />
	<mvt:assign name="g.ShipState" value="g.saved_fields:ship_state" />
	<mvt:assign name="g.ShipZip" value="g.saved_fields:ship_zip" />
	<mvt:assign name="g.ShipCountry" value="g.saved_fields:ship_cntry" />
	<mvt:assign name="g.BillFirstName" value="g.saved_fields:bill_fname" />
	<mvt:assign name="g.BillLastName" value="g.saved_fields:bill_lname" />
	<mvt:assign name="g.BillEmail" value="g.saved_fields:bill_email" />
	<mvt:assign name="g.BillCompany" value="g.saved_fields:bill_comp" />
	<mvt:assign name="g.BillPhone" value="g.saved_fields:bill_phone" />
	<mvt:assign name="g.BillFax" value="g.saved_fields:bill_fax" />
	<mvt:assign name="g.BillAddress1" value="g.saved_fields:bill_addr1" />
	<mvt:assign name="g.BillAddress2" value="g.saved_fields:bill_addr2" />
	<mvt:assign name="g.BillCity" value="g.saved_fields:bill_city" />
	<mvt:assign name="g.BillState" value="g.saved_fields:bill_state" />
	<mvt:assign name="g.BillZip" value="g.saved_fields:bill_zip" />
	<mvt:assign name="g.BillCountry" value="g.saved_fields:bill_cntry" />
</mvt:if>

<mvt:if expr="l.settings:customer:primaddr EQ 'shipping'">
	<mvt:assign name="l.settings:shipping_required" value="'required aria-required=' $ asciichar(34) $ 'true' $ asciichar(34)"/>
<mvt:elseif expr="l.settings:customer:primaddr EQ 'billing'">
	<mvt:assign name="l.settings:billing_required" value="'required aria-required=' $ asciichar(34) $ 'true' $ asciichar(34)"/>
</mvt:if>

<mvt:if expr="l.settings:basket:total GT 0">
	<mvt:assign name="l.settings:action" value="'ORDR'" />
	<mvt:assign name="l.settings:url" value="l.settings:urls:OUSL:secure" />
<mvt:elseif expr="g.Store:req_frship">
	<mvt:assign name="l.settings:action" value="'ORDR'" />
	<mvt:assign name="l.settings:url" value="l.settings:urls:OSEL:secure" />
<mvt:else>
	<mvt:assign name="l.settings:action" value="'ORDR,SHIP,CTAX,AUTH'" />
	<mvt:assign name="l.settings:url" value="l.settings:urls:INVC:secure" />
</mvt:if>

<mvt:do name="l.state_datalist_count" file="g.Module_Library_DB" value="StateList_Load_All(l.state_datalist)"/>
<mvt:assign name="g.StateDatalist" value="l.state_datalist"/>

<form data-validate-address method="post" action="&mvte:url;">
	<fieldset>
		<legend>&mvt:page:name;</legend>
		<input type="hidden" name="Action" value="&mvte:action;" />
		<mvt:if expr="g.Action EQ 'PAL2'">
			<input type="hidden" name="BasketPaymentGateway" value="1" />
			<mvt:item name="customfields" param="Write_Basket('BasketPaymentGateway', '1')" />
		</mvt:if>
		<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
			<div id="ShippingInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Shipping Information</div>
			<div class="c-form-list__item o-layout__item u-width-12 u-hidden" id="shipping_controls">
				<label class="c-form-checkbox">
					<input id="shipping_to_show" class="c-form-checkbox__input" type="checkbox" name="shipping_to_show" value="1" checked>
					<span class="c-form-checkbox__caption u-font-tiny">Shipping Information Same as Billing</span>
				</label>
			</div>
		</div>
		
		<section id="shipping_fields">
			<mvt:if expr="NOT ISNULL l.settings:customer:validated_ship_addresses">
				<input type="hidden" name="ShipValidated" value="1" />
			</mvt:if>
			<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified">
				<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipID_Row;">
						<label id="shipping_selector_label" class="c-form-label u-text-bold is-required u-font-tiny" for="shipping_selector">Saved Address</label>
						<div class="c-form-select">
							<select id="shipping_selector" class="c-form-select__dropdown c-form-input--large" name="ShipID" aria-describedby="ShippingInformation shipping_selector_label">
								<option value="-1">&lt;New&gt;</option>
								<mvt:foreach iterator="address" array="customer:addresses">
									<mvt:if expr="toupper( l.settings:address:fname ) EQ toupper( g.ShipFirstName ) AND toupper( l.settings:address:lname ) EQ toupper( g.ShipLastName ) AND toupper( l.settings:address:email ) EQ toupper( g.ShipEmail ) AND toupper( l.settings:address:comp ) EQ toupper( g.ShipCompany ) AND toupper( l.settings:address:phone ) EQ toupper( g.ShipPhone ) AND toupper( l.settings:address:fax ) EQ toupper( g.ShipFax ) AND toupper( l.settings:address:addr1 ) EQ toupper( g.ShipAddress1 ) AND toupper( l.settings:address:addr2 ) EQ toupper( g.ShipAddress2 ) AND toupper( l.settings:address:city ) EQ toupper( g.ShipCity ) AND ( ( ( NOT ISNULL g.ShipStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.ShipStateSelect ) ) ) OR ( ( ISNULL g.ShipStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.ShipState ) ) ) ) AND toupper( l.settings:address:zip ) EQ toupper( g.ShipZip ) AND toupper( l.settings:address:cntry ) EQ toupper( g.ShipCountry )">
										<option value="&mvte:address:id;" selected>&mvte:address:descrip;</option>
									<mvt:else>
										<option value="&mvte:address:id;">&mvte:address:descrip;</option>
									</mvt:if>
								</mvt:foreach>
							</select>
						</div>
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipDescription_Row;">
						<label id="ShipDescription_label" class="c-form-label u-font-small u-text-italic" for="ShipDescription">Description</label>
						<input id="ShipDescription" class="c-form-input c-form-input--large" type="text" name="ShipDescription" value="&mvte:global:ShipDescription;" aria-describedby="ShippingInformation ShipDescription_label" autocomplete="off">
					</div>
				</div>
			</mvt:if>
			<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipFirstName_Row;">
					<label id="ShipFirstName_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipFirstName">First Name</label>
					<input id="ShipFirstName" class="c-form-input c-form-input--large" type="text" name="ShipFirstName" value="&mvte:global:ShipFirstName;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipFirstName_label" autocomplete="given-name">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipLastName_Row;">
					<label id="ShipLastName_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipLastName">Last Name</label>
					<input id="ShipLastName" class="c-form-input c-form-input--large" type="text" name="ShipLastName" value="&mvte:global:ShipLastName;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipLastName_label" autocomplete="family-name">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipCompany_Row;">
					<label id="ShipCompany_label" class="c-form-label u-font-small u-text-italic" for="ShipCompany">Company (Optional)</label>
					<input id="ShipCompany" class="c-form-input c-form-input--large" type="text" name="ShipCompany" value="&mvte:global:ShipCompany;" aria-describedby="ShippingInformation ShipCompany_label" autocomplete="organization">
				</div>
				<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipEmail_Row;">
					<label id="ShipEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipEmail">Email Address</label>
					<input id="ShipEmail" class="c-form-input c-form-input--large" data-hook="ShipEmail" type="email" name="ShipEmail" value="&mvte:global:ShipEmail;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipEmail_label" autocomplete="email">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipPhone_Row;">
					<label id="ShipPhone_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipPhone">Phone Number</label>
					<input id="ShipPhone" class="c-form-input c-form-input--large" type="tel" name="ShipPhone" value="&mvte:global:ShipPhone;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipPhone_label" autocomplete="on">
				</div>
				<!--
				Due to the lack of use in most stores, the fax field is commented out.
				If you find that you, or a client, needs the field, remove the HTML comment tags and adjust
				the width class of the email address to u-width-4--m.
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipFax_Row;">
					<label id="ShipFax_label" class="c-form-label u-font-small u-text-italic" for="ShipFax">Fax Number</label>
					<input id="ShipFax" class="c-form-input c-form-input--large" type="tel" name="ShipFax" value="&mvte:global:ShipFax;" aria-describedby="ShippingInformation ShipFax_label">
				</div>
				-->
				<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipAddress1_Row;">
					<label id="ShipAddress1_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipAddress1">Address</label>
					<input id="ShipAddress1" class="c-form-input c-form-input--large" type="text" name="ShipAddress1" value="&mvte:global:ShipAddress1;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipAddress1_label" autocomplete="address-line1">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipAddress2_Row;">
					<label id="ShipAddress2_label" class="c-form-label u-font-small u-text-italic" for="ShipAddress2">Address 2</label>
					<input id="ShipAddress2" class="c-form-input c-form-input--large" type="text" name="ShipAddress2" value="&mvte:global:ShipAddress2;" aria-describedby="ShippingInformation ShipAddress2_label" autocomplete="address-line2">
				</div>
				<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipCity_Row;">
					<label id="ShipCity_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipCity">City</label>
					<input id="ShipCity" class="c-form-input c-form-input--large" type="text" name="ShipCity" value="&mvte:global:ShipCity;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipCity_label" autocomplete="address-level2">
				</div>

				<mvt:if expr="g.States_Empty">
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipState_Row;">
						<label id="ShipState_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipState">State/Province</label>
						<input id="ShipState" class="c-form-input c-form-input--large" type="text" name="ShipState" value="&mvte:global:ShipState;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipState_label" autocomplete="address-level1">
					</div>
				<mvt:else>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipState_Row;">
						<label id="ShipStateSelect_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipStateSelect">State/Province</label>
						<input name="ShipState" type="hidden" value="&mvte:global:ShipState;">
						<input id="ShipStateSelect" class="c-form-input c-form-input--large" data-datalist list="ShipStateDatalist" name="ShipStateSelect" placeholder="Select or Type" type="text" value="&mvte:global:ShipStateSelect;" &mvt:shipping_required; aria-describedby="ShippingInformation ShipStateSelect_label" autocomplete="address-level1">
						<datalist id="ShipStateDatalist">
							<mvt:foreach array="global:StateDatalist" iterator="StateData">
								<option value="&mvt:StateData:code;">&mvt:StateData:name;</option>
							</mvt:foreach>
						</datalist>
					</div>
				</mvt:if>

				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipCountry_Row;" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="ShipCountry" data-mvt-describedby="ShippingInformation ShipCountry_label" data-mvt-autocomplete="country">
					<label id="ShipCountry_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipCountry">Country</label>
					<div class="c-form-select">
						<mvt:item name="countries" param="ShipCountry" />
					</div>
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipZip_Row;">
					<label id="ShipZip_label" class="c-form-label u-font-small u-text-bold is-required" for="ShipZip">Zip/Postal Code</label>
					<input id="ShipZip" class="c-form-input c-form-input--large" type="text" name="ShipZip" value="&mvte:global:ShipZip;" aria-describedby="ShippingInformation ShipZip_label" autocomplete="postal-code">
				</div>
			</div>
			<hr class="c-keyline">
		</section>
		
		<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
			<div id="BillingInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Billing Information</div>
			<div class="c-form-list__item o-layout__item u-width-12 u-font-small" id="billing_controls">
				<label class="c-form-checkbox">
					<input id="billing_to_show" class="c-form-checkbox__input" type="checkbox" name="billing_to_show" value="1" checked>
					<span class="c-form-checkbox__caption u-font-small u-text-uppercase">Billing Information Same as Shipping</span>
				</label>
			</div>
		</div>
		
		<section id="billing_fields">
			<mvt:if expr="NOT ISNULL l.settings:customer:validated_bill_addresses">
				<input type="hidden" name="BillValidated" value="1" />
			</mvt:if>
			<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified">
				<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillID_Row;">
						<label id="billing_selector_label" class="c-form-label u-text-bold is-required u-font-tiny" for="billing_selector">Saved Address</label>
						<div class="c-form-select">
							<select id="billing_selector" class="c-form-select__dropdown c-form-input--large" name="BillID" aria-describedby="BillingInformation billing_selector_label">
								<option value="-1">&lt;New&gt;</option>
								<mvt:foreach iterator="address" array="customer:addresses">
									<mvt:if expr="toupper( l.settings:address:fname ) EQ toupper( g.BillFirstName ) AND toupper( l.settings:address:lname ) EQ toupper( g.BillLastName ) AND toupper( l.settings:address:email ) EQ toupper( g.BillEmail ) AND toupper( l.settings:address:comp ) EQ toupper( g.BillCompany ) AND toupper( l.settings:address:phone ) EQ toupper( g.BillPhone ) AND toupper( l.settings:address:fax ) EQ toupper( g.BillFax ) AND toupper( l.settings:address:addr1 ) EQ toupper( g.BillAddress1 ) AND toupper( l.settings:address:addr2 ) EQ toupper( g.BillAddress2 ) AND toupper( l.settings:address:city ) EQ toupper( g.BillCity ) AND ( ( ( NOT ISNULL g.BillStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.BillStateSelect ) ) ) OR ( ( ISNULL g.BillStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.BillState ) ) ) ) AND toupper( l.settings:address:zip ) EQ toupper( g.BillZip ) AND toupper( l.settings:address:cntry ) EQ toupper( g.BillCountry )">
										<option value="&mvte:address:id;" selected>&mvte:address:descrip;</option>
									<mvt:else>
										<option value="&mvte:address:id;">&mvte:address:descrip;</option>
									</mvt:if>
								</mvt:foreach>
							</select>
						</div>
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillDescription_Row;">
						<label id="BillDescription_label" class="c-form-label u-font-small u-text-italic" for="BillDescription">Description</label>
						<input id="BillDescription" class="c-form-input c-form-input--large" type="text" name="BillDescription" value="&mvte:global:BillDescription;" aria-describedby="BillingInformation BillDescription_label" autocomplete="off">
					</div>
				</div>
			</mvt:if>
			<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillFirstName_Row;">
					<label id="BillFirstName_label" class="c-form-label u-font-small u-text-bold is-required" for="BillFirstName">First Name</label>
					<input id="BillFirstName" class="c-form-input c-form-input--large" type="text" name="BillFirstName" value="&mvte:global:BillFirstName;" &mvt:billing_required; aria-describedby="BillingInformation BillFirstName_label" autocomplete="given-name">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillLastName_Row;">
					<label id="BillLastName_label" class="c-form-label u-font-small u-text-bold is-required" for="BillLastName">Last Name</label>
					<input id="BillLastName" class="c-form-input c-form-input--large" type="text" name="BillLastName" value="&mvte:global:BillLastName;" &mvt:billing_required; aria-describedby="BillingInformation BillLastName_label" autocomplete="family-name">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillCompany_Row;">
					<label id="BillCompany_label" class="c-form-label u-font-small u-text-italic" for="BillCompany">Company (Optional)</label>
					<input id="BillCompany" class="c-form-input c-form-input--large" type="text" name="BillCompany" value="&mvte:global:BillCompany;" aria-describedby="BillingInformation BillCompany_label" autocomplete="organization">
				</div>
				<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillEmail_Row;">
					<label id="BillEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="BillEmail">Email Address</label>
					<input id="BillEmail" class="c-form-input c-form-input--large" data-hook="BillEmail" type="email" name="BillEmail" value="&mvte:global:BillEmail;" &mvt:billing_required; aria-describedby="BillingInformation BillEmail_label" autocomplete="email">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillPhone_Row;">
					<label id="BillPhone_label" class="c-form-label u-font-small u-text-bold is-required" for="BillPhone">Phone Number</label>
					<input id="BillPhone" class="c-form-input c-form-input--large" type="tel" name="BillPhone" value="&mvte:global:BillPhone;" &mvt:billing_required; aria-describedby="BillingInformation BillPhone_label" autocomplete="on">
				</div>
				<!--
				Due to the lack of use in most stores, the fax field is commented out.
				If you find that you, or a client, needs the field, remove the HTML comment tags and adjust
				the width class of the email address to u-width-4--m.
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillFax_Row;">
					<label id="BillFax_label" class="c-form-label u-font-small u-text-italic" for="BillFax">Fax Number</label>
					<input id="BillFax" class="c-form-input c-form-input--large" type="tel" name="BillFax" value="&mvte:global:BillFax;" aria-describedby="BillingInformation BillFax_label">
				</div>
				-->
				<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillAddress1_Row;">
					<label id="BillAddress1_label" class="c-form-label u-font-small u-text-bold is-required" for="BillAddress1">Address</label>
					<input id="BillAddress1" class="c-form-input c-form-input--large" type="text" name="BillAddress1" value="&mvte:global:BillAddress1;" &mvt:billing_required; aria-describedby="BillingInformation BillAddress1_label" autocomplete="address-line1">
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillAddress2_Row;">
					<label id="BillAddress2_label" class="c-form-label u-font-small u-text-italic" for="BillAddress2">Address 2</label>
					<input id="BillAddress2" class="c-form-input c-form-input--large" type="text" name="BillAddress2" value="&mvte:global:BillAddress2;" aria-describedby="BillingInformation BillAddress2_label" autocomplete="address-line2">
				</div>
				<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillCity_Row;">
					<label id="BillCity_label" class="c-form-label u-font-small u-text-bold is-required" for="BillCity">City</label>
					<input id="BillCity" class="c-form-input c-form-input--large" type="text" name="BillCity" value="&mvte:global:BillCity;" &mvt:billing_required; aria-describedby="BillingInformation BillCity_label" autocomplete="address-level2">
				</div>
				
				<mvt:if expr="g.States_Empty">
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillState_Row;">
						<label id="BillState_label" class="c-form-label u-font-small u-text-bold is-required" for="BillState">State/Province</label>
						<input id="BillState" class="c-form-input c-form-input--large" type="text" name="BillState" value="&mvte:global:BillState;" &mvt:shipping_required; aria-describedby="BillingInformation BillState_label" autocomplete="address-level1">
					</div>
				<mvt:else>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillState_Row;">
						<label id="BillStateSelect_label" class="c-form-label u-font-small u-text-bold is-required" for="BillStateSelect">State/Province</label>
						<input name="BillState" type="hidden" value="&mvte:global:BillState;">
						<input id="BillStateSelect" class="c-form-input c-form-input--large" data-datalist list="BillStateDatalist" name="BillStateSelect" placeholder="Select or Type" type="text" value="&mvte:global:BillStateSelect;" &mvt:billing_required; aria-describedby="BillingInformation BillStateSelect_label" autocomplete="address-level1">
						<datalist id="BillStateDatalist">
							<mvt:foreach array="global:StateDatalist" iterator="StateData">
								<option value="&mvt:StateData:code;">&mvt:StateData:name;</option>
							</mvt:foreach>
						</datalist>
					</div>
				</mvt:if>
				
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillCountry_Row;" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="BillCountry" data-mvt-describedby="BillingInformation BillCountry_label" data-mvt-autocomplete="country">
					<label id="BillCountry_label" class="c-form-label u-font-small u-text-bold is-required" for="BillCountry">Country</label>
					<div class="c-form-select">
						<mvt:item name="countries" param="BillCountry" />
					</div>
				</div>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillZip_Row;">
					<label id="BillZip_label" class="c-form-label u-font-small u-text-bold is-required" for="BillZip">Zip/Postal Code</label>
					<input id="BillZip" class="c-form-input c-form-input--large" type="text" name="BillZip" value="&mvte:global:BillZip;" aria-describedby="BillingInformation BillZip_label" autocomplete="postal-code">
				</div>
			</div>
			<hr class="c-keyline">
		</section>

		<div class="c-form-list u-text-uppercase">
			<mvt:foreach array="tax:fields" iterator="field">
				<mvt:if expr="l.settings:field:invalid">
					<div class="c-form-list__item u-text-bold is-error" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="tax">
						<label class="c-form-label u-font-small" for="tax">&mvt:field:prompt;</label>
						<div class="c-form-select">
							<mvt:item name="tax" param="field:code" />
						</div>
					</div>
				<mvt:else>
					<div class="c-form-list__item u-text-bold" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="tax">
						<label class="c-form-label u-font-small" for="tax">&mvt:field:prompt;</label>
						<div class="c-form-select">
							<mvt:item name="tax" param="field:code" />
						</div>
					</div>
				</mvt:if>
			</mvt:foreach>
			<mvt:if expr="g.Basket:cust_id">
				<div class="c-form-list__item c-form-list__item--full u-font-small">
					<mvt:if expr="g.Update_Customer">
						<label class="c-form-checkbox">
							<input class="c-form-checkbox__input" type="checkbox" name="Update_Customer" value="Yes" checked>
							<span class="c-form-checkbox__caption u-font-small">Update Customer Record With This Information</span>
						</label>
					<mvt:else>
						<label class="c-form-checkbox">
							<input class="c-form-checkbox__input" type="checkbox" name="Update_Customer" value="Yes">
							<span class="c-form-checkbox__caption u-font-small">Update Customer Record With This Information</span>
						</label>
					</mvt:if>
				</div>
			</mvt:if>
		</div>
		
		<mvt:if expr="l.settings:customer:match">
			<mvt:if expr="l.settings:customer:primaddr EQ 'shipping'">
				<script>document.getElementById('billing_to_show').checked = true;</script>
			<mvt:elseif expr="l.settings:customer:primaddr EQ 'billing'">
				<script>document.getElementById('shipping_to_show').checked = true;</script>
			</mvt:if>
		</mvt:if>
		
		<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified AND l.settings:customer:address_count">
			<script>
				var MvCustomerAddresses = [];
	
				<mvt:foreach iterator="address" array="customer:addresses">
					MvCustomerAddresses[<mvt:eval expr="int( l.settings:address:id )" />] = {
						"id": <mvt:eval expr="int( l.settings:address:id )" />,
						"cust_id": <mvt:eval expr="int( l.settings:address:cust_id )" />,
						"descrip": "&mvtj:address:descrip;",
						"fname": "&mvtj:address:fname;",
						"lname": "&mvtj:address:lname;",
						"email": "&mvtj:address:email;",
						"comp": "&mvtj:address:comp;",
						"phone": "&mvtj:address:phone;",
						"fax": "&mvtj:address:fax;",
						"addr1": "&mvtj:address:addr1;",
						"addr2": "&mvtj:address:addr2;",
						"city": "&mvtj:address:city;",
						"state": "&mvtj:address:state;",
						"zip": "&mvtj:address:zip;",
						"cntry": "&mvtj:address:cntry;",
						"resdntl": <mvt:if expr="l.settings:address:resdntl">true<mvt:else>false</mvt:if>
					};
				</mvt:foreach>
			</script>
		</mvt:if>
		
		<div class="c-form-list">
			<div class="c-form-list__item c-form-list__item--full u-text-center u-text-right--l">
				<input class="c-button c-button--huge u-bg-gray-50 u-font-small u-text-medium u-text-uppercase" type="submit" value="Continue to Shipping">
			</div>
		</div>
	</fieldset>
</form>

<script src="&mvte:global:clientside_url;Store_Code=&mvta:store:code;&amp;Filename=ToggleDetails.js&amp;Primaddr=shipping&amp;Shipping=D&amp;Billing=O"></script>
<script>
	(function () {
		'use strict';

		/**
		 * This function is an enhancement to the `datalist` State/Province and Country replacement.
		 * Since a customer can type a value in the input, this will check if the entered value
		 * matches one of the output values or text entries. If so, it passes the value back to
		 * ensure proper functionality with shipping modules, i.e. 2 letter abbreviations for
		 * US and Canada. Otherwise, it the entry is used as typed.
		 * @type {NodeListOf<Element>}
		 */

		let datalist = document.querySelectorAll('[data-datalist]');

		function checkOption(entry, list) {
			let datalist = document.querySelector('#' + list);
			let datalistOptions = datalist.querySelectorAll('option');
			let value = '';

			for (let i = 0; i < datalistOptions.length; i++) {
				let option = datalistOptions[i];

				if (entry.toLowerCase() === option.value.toLowerCase() || entry.toLowerCase() === option.text.toLowerCase()) {
					value = option.value;
				}
			}

			return value;
		}

		if (datalist.length > 0) {
			for (let i = 0; i < datalist.length; i++) {
				let list = datalist[i];

				list.addEventListener('blur', function () {
					let thisDatalist = list.getAttribute('list');
					let checkValue = checkOption(list.value, thisDatalist);

					if (checkValue) {
						list.value = checkValue;
						list.previousElementSibling.value = checkValue;
					}
					else {
						list.previousElementSibling.value = list.value;
					}
				});
			}
		}
	}());
</script>
]]></Template><Mode>checkout_editable</Mode><PreventAutomaticTemplateUpdates>Yes</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="ACAD"><Item code="customer"><Template><![CDATA[<section class="o-layout o-layout--justify-center">
	<div class="o-layout__item u-width-12 u-width-9--m">
		<mvt:do file="g.Module_Library_DB" name="l.state_datalist_count" value="StateList_Load_All(l.state_datalist)"/>
		<mvt:assign name="g.StateDatalist" value="l.state_datalist"/>
		
		<mvt:if expr="l.settings:customer:primaddr EQ 'shipping'">
			<mvt:assign name="l.settings:shipping_required" value="'required'" />
		<mvt:elseif expr="l.settings:customer:primaddr EQ 'billing'">
			<mvt:assign name="l.settings:billing_required" value="'required'" />
		</mvt:if>
		
		<mvt:if expr="g.Order">
			<mvt:assign name="l.settings:url" value="l.settings:urls:OINF:secure" />
		<mvt:elseif expr="g.Redeem">
			<mvt:assign name="l.settings:url" value="l.settings:urls:RGFT:secure" />
		<mvt:elseif expr="g.WishList">
			<mvt:assign name="l.settings:url" value="l.settings:urls:WISH:secure" />
		<mvt:else>
			<mvt:assign name="l.settings:url" value="l.settings:urls:ACLN:secure" />
		</mvt:if>
		<form method="post" action="&mvte:url;" data-validate-address>
			<input type="hidden" name="Action" value="ICST" />
			<input type="hidden" name="Order" value="&mvte:global:Order;" />
			<input type="hidden" name="NewAccount" value="1" />
			<input type="hidden" name="CSRF_Token" value="&mvte:global:Basket:csrf_token;">
			
			<div class="c-form-list o-layout u-text-uppercase">
				<div id="LogInInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Log In Information</div>
				<div class="c-form-list__item o-layout__item u-width-12 &mvte:global:LoginEmail_Row;">
					<label id="Customer_LoginEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_LoginEmail">Email Address</label>
					<input id="Customer_LoginEmail" class="c-form-input c-form-input--large" data-hook="Customer_LoginEmail" data-primary="&mvt:customer:primaddr" type="email" name="Customer_LoginEmail" value="&mvte:global:Customer_LoginEmail;" autocomplete="email" required aria-describedby="LogInInformation Customer_LoginEmail_label" aria-required="true">
				</div>
				<div class="c-form-list__item o-layout__item u-width-6--m &mvte:global:Password_Row;">
					<label id="Customer_Password_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_Password">Password</label>
					<input id="Customer_Password" class="c-form-input c-form-input--large" type="password" name="Customer_Password" value="&mvte:global:Customer_Password;" autocomplete="new-password" required aria-describedby="LogInInformation Customer_Password_label" aria-required="true">
				</div>
				<div class="c-form-list__item o-layout__item u-width-6--m &mvte:global:VerifyPassword_Row;">
					<label id="Customer_VerifyPassword_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_VerifyPassword">Confirm Password</label>
					<input id="Customer_VerifyPassword" class="c-form-input c-form-input--large" type="password" name="Customer_VerifyPassword" value="&mvte:global:Customer_VerifyPassword;" autocomplete="new-password" required aria-describedby="LogInInformation Customer_VerifyPassword_label" aria-required="true">
				</div>
			</div>
			<hr class="c-keyline">
			
			<div class="c-form-list o-layout">
				<div id="ShippingInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Shipping Information</div>
				<div class="c-form-list__item o-layout__item u-width-12 u-font-small u-hidden" id="shipping_controls">
					<label class="c-form-checkbox">
						<mvt:if expr="g.Action AND g.shipping_to_show">
							<input id="shipping_to_show" class="c-form-checkbox__input" type="checkbox" name="shipping_to_show" value="1" checked>
						<mvt:else>
							<input id="shipping_to_show" class="c-form-checkbox__input" type="checkbox" name="shipping_to_show" value="1">
						</mvt:if>
						<span class="c-form-checkbox__caption u-font-tiny">Shipping Information Same as Billing</span>
					</label>
				</div>
			</div>
			
			<section id="shipping_fields">
				<mvt:if expr="NOT ISNULL l.settings:customer:validated_ship_addresses">
					<input type="hidden" name="Customer_ShipValidated" value="1" />
				</mvt:if>
				<div class="c-form-list o-layout u-text-uppercase">
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipFirstName_Row;">
						<label id="Customer_ShipFirstName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipFirstName">First Name</label>
						<input id="Customer_ShipFirstName" class="c-form-input c-form-input--large" type="text" name="Customer_ShipFirstName" value="&mvte:global:Customer_ShipFirstName;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipFirstName_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipLastName_Row;">
						<label id="Customer_ShipLastName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipLastName">Last Name</label>
						<input id="Customer_ShipLastName" class="c-form-input c-form-input--large" type="text" name="Customer_ShipLastName" value="&mvte:global:Customer_ShipLastName;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipLastName_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipCompany_Row;">
						<label id="Customer_ShipCompany_label" class="c-form-label u-font-small u-text-italic" for="Customer_ShipCompany">Company (Optional)</label>
						<input id="Customer_ShipCompany" class="c-form-input c-form-input--large" type="text" name="Customer_ShipCompany" value="&mvte:global:Customer_ShipCompany;" aria-describedby="ShippingInformation Customer_ShipCompany_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipEmail_Row;">
						<label id="Customer_ShipEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipEmail">Email Address</label>
						<input id="Customer_ShipEmail" class="c-form-input c-form-input--large" data-hook="Customer_ShipEmail" type="email" name="Customer_ShipEmail" value="&mvte:global:Customer_ShipEmail;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipEmail_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipPhone_Row;">
						<label id="Customer_ShipPhone_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipPhone">Phone Number</label>
						<input id="Customer_ShipPhone" class="c-form-input c-form-input--large" type="tel" name="Customer_ShipPhone" value="&mvte:global:Customer_ShipPhone;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipPhone_label">
					</div>
					<!--
					Due to the lack of use in most stores, the fax field is commented out.
					If you find that you, or a client, needs the field, remove the HTML comment tags and adjust
					the width class of the email address to u-width-4--m.
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipFax_Row;">
						<label id="Customer_ShipFax_label" class="c-form-label u-font-small u-text-italic" for="Customer_ShipFax">Fax Number</label>
						<input id="Customer_ShipFax" class="c-form-input c-form-input--large" type="tel" name="Customer_ShipFax" value="&mvte:global:Customer_ShipFax;" aria-describedby="ShippingInformation Customer_ShipFax_label">
					</div>
					-->
					<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipAddress1_Row;">
						<label id="Customer_ShipAddress1_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipAddress1">Address</label>
						<input id="Customer_ShipAddress1" class="c-form-input c-form-input--large" type="text" name="Customer_ShipAddress1" value="&mvte:global:Customer_ShipAddress1;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipAddress1_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipAddress2_Row;">
						<label id="Customer_ShipAddress2_label" class="c-form-label u-font-small u-text-italic" for="Customer_ShipAddress2">Address 2</label>
						<input id="Customer_ShipAddress2" class="c-form-input c-form-input--large" type="text" name="Customer_ShipAddress2" value="&mvte:global:Customer_ShipAddress2;" aria-describedby="ShippingInformation Customer_ShipAddress2_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipCity_Row;">
						<label id="Customer_ShipCity_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipCity">City</label>
						<input id="Customer_ShipCity" class="c-form-input c-form-input--large" type="text" name="Customer_ShipCity" value="&mvte:global:Customer_ShipCity;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipCity_label">
					</div>
					
					<mvt:if expr="g.States_Empty">
						<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipState_Row;">
							<label id="Customer_ShipState_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipState">State/Province</label>
							<input id="Customer_ShipState" class="c-form-input c-form-input--large" type="text" name="Customer_ShipState" value="&mvte:global:Customer_ShipState;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipState_label">
						</div>
					<mvt:else>
						<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipState_Row;">
							<label id="Customer_ShipStateSelect_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipStateSelect">State/Province</label>
							<input name="Customer_ShipState" type="hidden" value="&mvte:global:Customer_ShipState;">
							<input id="Customer_ShipStateSelect" class="c-form-input c-form-input--large" data-datalist list="ShipStateDatalist" name="Customer_ShipStateSelect" placeholder="Select or Type" type="text" value="&mvte:global:Customer_ShipStateSelect;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipStateSelect_label">
							<datalist id="ShipStateDatalist">
								<mvt:foreach array="global:StateDatalist" iterator="StateData">
									<option value="&mvt:StateData:code;">&mvt:StateData:name;</option>
								</mvt:foreach>
							</datalist>
						</div>
					</mvt:if>
					
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipCountry_Row;" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="Customer_ShipCountry" data-mvt-describedby="ShippingInformation Customer_ShipCountry_label" data-mvt-autocomplete="country">
						<label id="Customer_ShipCountry_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipCountry">Country</label>
						<div class="c-form-select">
							<mvt:item name="countries" param="Customer_ShipCountry" />
						</div>
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipZip_Row;">
						<label id="Customer_ShipZip_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipZip">Zip/Postal Code</label>
						<input id="Customer_ShipZip" class="c-form-input c-form-input--large" type="text" name="Customer_ShipZip" value="&mvte:global:Customer_ShipZip;" aria-describedby="ShippingInformation Customer_ShipZip_label">
					</div>
				</div>
				<hr class="c-keyline">
			</section>
			
			<div class="c-form-list o-layout">
				<div id="BillingInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Billing Information</div>
				<div class="c-form-list__item o-layout__item u-width-12 u-font-small" id="billing_controls">
					<label class="c-form-checkbox">
						<mvt:if expr="g.Action AND g.billing_to_show">
							<input id="billing_to_show" class="c-form-checkbox__input" type="checkbox" name="billing_to_show" value="1" checked>
						<mvt:else>
							<input id="billing_to_show" class="c-form-checkbox__input" type="checkbox" name="billing_to_show" value="1">
						</mvt:if>
						<span class="c-form-checkbox__caption u-font-small u-text-uppercase">Billing Information Same as Shipping</span>
					</label>
				</div>
			</div>
	
			<section id="billing_fields">
				<mvt:if expr="NOT ISNULL l.settings:customer:validated_bill_addresses">
					<input type="hidden" name="Customer_BillValidated" value="1" />
				</mvt:if>
				<div class="c-form-list o-layout">
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillFirstName_Row;">
						<label id="Customer_BillFirstName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillFirstName">First Name</label>
						<input id="Customer_BillFirstName" class="c-form-input c-form-input--large" type="text" name="Customer_BillFirstName" value="&mvte:global:Customer_BillFirstName;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillFirstName_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillLastName_Row;">
						<label id="Customer_BillLastName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillLastName">Last Name</label>
						<input id="Customer_BillLastName" class="c-form-input c-form-input--large" type="text" name="Customer_BillLastName" value="&mvte:global:Customer_BillLastName;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillLastName_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillCompany_Row;">
						<label id="Customer_BillCompany_label" class="c-form-label u-font-small u-text-italic" for="Customer_BillCompany">Company (Optional)</label>
						<input id="Customer_BillCompany" class="c-form-input c-form-input--large" type="text" name="Customer_BillCompany" value="&mvte:global:Customer_BillCompany;" aria-describedby="BillingInformation Customer_BillCompany_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillEmail_Row;">
						<label id="Customer_BillEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillEmail">Email Address</label>
						<input id="Customer_BillEmail" class="c-form-input c-form-input--large" data-hook="Customer_BillEmail" type="email" name="Customer_BillEmail" value="&mvte:global:Customer_BillEmail;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillEmail_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillPhone_Row;">
						<label id="Customer_BillPhone_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillPhone">Phone Number</label>
						<input id="Customer_BillPhone" class="c-form-input c-form-input--large" type="tel" name="Customer_BillPhone" value="&mvte:global:Customer_BillPhone;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillPhone_label">
					</div>
					<!--
					Due to the lack of use in most stores, the fax field is commented out.
					If you find that you, or a client, needs the field, remove the HTML comment tags and adjust
					the width class of the email address to u-width-4--m.
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillFax_Row;">
						<label id="Customer_BillFax_label" class="c-form-label u-font-small u-text-italic" for="Customer_BillFax">Fax Number</label>
						<input id="Customer_BillFax" class="c-form-input c-form-input--large" type="tel" name="Customer_BillFax" value="&mvte:global:Customer_BillFax;" aria-describedby="BillingInformation Customer_BillFax_label">
					</div>
					-->
					<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillAddress1_Row;">
						<label id="Customer_BillAddress1_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillAddress1">Address</label>
						<input id="Customer_BillAddress1" class="c-form-input c-form-input--large" type="text" name="Customer_BillAddress1" value="&mvte:global:Customer_BillAddress1;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillAddress1_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillAddress2_Row;">
						<label id="Customer_BillAddress2_label" class="c-form-label u-font-small u-text-italic" for="Customer_BillAddress2">Address 2</label>
						<input id="Customer_BillAddress2" class="c-form-input c-form-input--large" type="text" name="Customer_BillAddress2" value="&mvte:global:Customer_BillAddress2;" aria-describedby="BillingInformation Customer_BillAddress2_label">
					</div>
					<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillCity_Row;">
						<label id="Customer_BillCity_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillCity">City</label>
						<input id="Customer_BillCity" class="c-form-input c-form-input--large" type="text" name="Customer_BillCity" value="&mvte:global:Customer_BillCity;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillCity_label">
					</div>
					
					<mvt:if expr="g.States_Empty">
						<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillState_Row;">
							<label id="Customer_BillState_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillState">State/Province</label>
							<input id="Customer_BillState" class="c-form-input c-form-input--large" type="text" name="Customer_BillState" value="&mvte:global:Customer_BillState;" &mvt:shipping_required; aria-describedby="BillingInformation Customer_BillState_label">
						</div>
					<mvt:else>
						<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillState_Row;">
							<label id="Customer_BillStateSelect_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillStateSelect">State/Province</label>
							<input name="Customer_BillState" type="hidden" value="&mvte:global:Customer_BillState;">
							<input id="Customer_BillStateSelect" class="c-form-input c-form-input--large" data-datalist list="BillStateDatalist" name="Customer_BillStateSelect" placeholder="Select or Type" type="text" value="&mvte:global:Customer_BillStateSelect;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillStateSelect_label">
							<datalist id="BillStateDatalist">
								<mvt:foreach array="global:StateDatalist" iterator="StateData">
									<option value="&mvt:StateData:code;">&mvt:StateData:name;</option>
								</mvt:foreach>
							</datalist>
						</div>
					</mvt:if>
					
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillCountry_Row;" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="Customer_BillCountry" data-mvt-describedby="BillingInformation Customer_BillCountry_label" data-mvt-autocomplete="country">
						<label id="Customer_BillCountry_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillCountry">Country</label>
						<div class="c-form-select">
							<mvt:item name="countries" param="Customer_BillCountry" />
						</div>
					</div>
					<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillZip_Row;">
						<label id="Customer_BillZip_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillZip">Zip/Postal Code</label>
						<input id="Customer_BillZip" class="c-form-input c-form-input--large" type="text" name="Customer_BillZip" value="&mvte:global:Customer_BillZip;" aria-describedby="BillingInformation Customer_BillZip_label">
					</div>
				</div>
				<hr class="c-keyline">
			</section>
			
			<mvt:if expr="l.settings:customer:match">
				<mvt:if expr="l.settings:customer:primaddr EQ 'shipping'">
					<script>document.getElementById('billing_to_show').checked = true;</script>
				<mvt:elseif expr="l.settings:customer:primaddr EQ 'billing'">
					<script>document.getElementById('shipping_to_show').checked = true;</script>
				</mvt:if>
			</mvt:if>
			
			<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified AND l.settings:customer:address_count">
				<script>
					var MvCustomerAddresses = [];
		
					<mvt:foreach iterator="address" array="customer:addresses">
						MvCustomerAddresses[<mvt:eval expr="int( l.settings:address:id )" />] = {
							"id": <mvt:eval expr="int( l.settings:address:id )" />,
							"cust_id": <mvt:eval expr="int( l.settings:address:cust_id )" />,
							"descrip": "&mvtj:address:descrip;",
							"fname": "&mvtj:address:fname;",
							"lname": "&mvtj:address:lname;",
							"email": "&mvtj:address:email;",
							"comp": "&mvtj:address:comp;",
							"phone": "&mvtj:address:phone;",
							"fax": "&mvtj:address:fax;",
							"addr1": "&mvtj:address:addr1;",
							"addr2": "&mvtj:address:addr2;",
							"city": "&mvtj:address:city;",
							"state": "&mvtj:address:state;",
							"zip": "&mvtj:address:zip;",
							"cntry": "&mvtj:address:cntry;",
							"resdntl": <mvt:if expr="l.settings:address:resdntl">true<mvt:else>false</mvt:if>
						};
					</mvt:foreach>
				</script>
			</mvt:if>
			
			<div class="c-form-list u-text-center">
				<div class="c-form-list__item u-inline-block">
					<input class="c-button c-button--full c-button--huge u-font-small u-bg-gray-40 u-text-bold u-text-uppercase" type="submit" value="Save">
				</div>
			</div>
		</form>
	</div>
</section>
<script src="&mvte:global:clientside_url;Store_Code=&mvta:store:code;&amp;Filename=ToggleDetails.js&amp;Primaddr=shipping&amp;Shipping=D&amp;Billing=O"></script>


<script>
	(function () {
		'use strict';

		/**
		 * This function is an enhancement to the `datalist` State/Province and Country replacement.
		 * Since a customer can type a value in the input, this will check if the entered value
		 * matches one of the output values or text entries. If so, it passes the value back to
		 * ensure proper functionality with shipping modules, i.e. 2 letter abbreviations for
		 * US and Canada. Otherwise, it the entry is used as typed.
		 * @type {NodeListOf<Element>}
		 */

		let datalist = document.querySelectorAll('[data-datalist]');

		function checkOption(entry, list) {
			let datalist = document.querySelector('#' + list);
			let datalistOptions = datalist.querySelectorAll('option');
			let value = '';

			for (let i = 0; i < datalistOptions.length; i++) {
				let option = datalistOptions[i];

				if (entry.toLowerCase() === option.value.toLowerCase() || entry.toLowerCase() === option.text.toLowerCase()) {
					value = option.value;
				}
			}

			return value;
		}

		if (datalist.length > 0) {
			for (let i = 0; i < datalist.length; i++) {
				let list = datalist[i];

				list.addEventListener('blur', function () {
					let thisDatalist = list.getAttribute('list');
					let checkValue = checkOption(list.value, thisDatalist);

					if (checkValue) {
						list.value = checkValue;
						list.previousElementSibling.value = checkValue;
					}
					else {
						list.previousElementSibling.value = list.value;
					}
				});
			}
		}
	}());
</script>
]]></Template><Mode>customer_add</Mode><PreventAutomaticTemplateUpdates>Yes</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="ACED"><Item code="customer"><Template><![CDATA[<mvt:do file="g.Module_Library_DB" name="l.state_datalist_count" value="StateList_Load_All(l.state_datalist)"/>
<mvt:assign name="g.StateDatalist" value="l.state_datalist"/>

<mvt:if expr="l.settings:customer:primaddr EQ 'shipping'">
	<mvt:assign name="l.settings:shipping_required" value="'required'" />
<mvt:elseif expr="l.settings:customer:primaddr EQ 'billing'">
	<mvt:assign name="l.settings:billing_required" value="'required'" />
</mvt:if>

<form method="post" action="&mvte:urls:ACED:secure;" data-validate-address>
	<input type="hidden" name="Action" value="UCST" />
	<input type="hidden" name="updated" value="1" />
	<input type="hidden" name="Customer_Login" value="&mvte:global:Customer:login;">
	<input type="hidden" name="Customer_PasswordEmail" value="&mvte:global:Customer:pw_email;">
	<input type="hidden" name="CSRF_Token" value="&mvte:global:Basket:csrf_token;">
	
	<div class="c-form-list o-layout">
		<div id="ShippingInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Shipping Information</div>
		<div class="c-form-list__item o-layout__item u-width-12 u-font-small u-hidden" id="shipping_controls">
			<mvt:if expr="g.Action AND g.shipping_to_show">
				<label class="c-form-checkbox">
					<input id="shipping_to_show" class="c-form-checkbox__input" type="checkbox" name="shipping_to_show" value="1" checked>
					<span class="c-form-checkbox__caption u-font-tiny">Shipping Information Same as Billing</span>
				</label>
			<mvt:else>
				<label class="c-form-checkbox">
					<input id="shipping_to_show" class="c-form-checkbox__input" type="checkbox" name="shipping_to_show" value="1">
					<span class="c-form-checkbox__caption u-font-tiny">Shipping Information Same as Billing</span>
				</label>
			</mvt:if>
		</div>
		<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified">
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipID_Row;">
				<label id="shipping_selector_label" class="c-form-label u-font-tiny u-text-bold is-required" for="shipping_selector">Saved Address</label>
				<div class="c-form-select">
					<select id="shipping_selector" class="c-form-select__dropdown c-form-input--large" name="ShipID" aria-describedby="ShippingInformation shipping_selector_label">
						<mvt:foreach iterator="address" array="customer:addresses">
							<mvt:if expr="toupper( l.settings:address:fname ) EQ toupper( g.ShipFirstName ) AND toupper( l.settings:address:lname ) EQ toupper( g.ShipLastName ) AND toupper( l.settings:address:email ) EQ toupper( g.ShipEmail ) AND toupper( l.settings:address:comp ) EQ toupper( g.ShipCompany ) AND toupper( l.settings:address:phone ) EQ toupper( g.ShipPhone ) AND toupper( l.settings:address:fax ) EQ toupper( g.ShipFax ) AND toupper( l.settings:address:addr1 ) EQ toupper( g.ShipAddress1 ) AND toupper( l.settings:address:addr2 ) EQ toupper( g.ShipAddress2 ) AND toupper( l.settings:address:city ) EQ toupper( g.ShipCity ) AND ( ( ( NOT ISNULL g.ShipStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.ShipStateSelect ) ) ) OR ( ( ISNULL g.ShipStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.ShipState ) ) ) ) AND toupper( l.settings:address:zip ) EQ toupper( g.ShipZip ) AND toupper( l.settings:address:cntry ) EQ toupper( g.ShipCountry )">
								<option value="&mvte:address:id;" selected>&mvte:address:descrip;</option>
							<mvt:else>
								<option value="&mvte:address:id;">&mvte:address:descrip;</option>
							</mvt:if>
						</mvt:foreach>
						<option value="-1">&lt;New&gt;</option>
					</select>
				</div>
			</div>
		</mvt:if>
	</div>
	
	<section id="shipping_fields">
		<mvt:if expr="NOT ISNULL l.settings:customer:validated_ship_addresses">
			<input type="hidden" name="Customer_ShipValidated" value="1" />
		</mvt:if>
		<div class="c-form-list o-layout u-text-uppercase">
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipFirstName_Row;">
				<label id="Customer_ShipFirstName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipFirstName">First Name</label>
				<input id="Customer_ShipFirstName" class="c-form-input c-form-input--large" type="text" name="Customer_ShipFirstName" value="&mvte:global:Customer_ShipFirstName;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipFirstName_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipLastName_Row;">
				<label id="Customer_ShipLastName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipLastName">Last Name</label>
				<input id="Customer_ShipLastName" class="c-form-input c-form-input--large" type="text" name="Customer_ShipLastName" value="&mvte:global:Customer_ShipLastName;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipLastName_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipCompany_Row;">
				<label id="Customer_ShipCompany_label" class="c-form-label u-font-small u-text-italic" for="Customer_ShipCompany">Company (Optional)</label>
				<input id="Customer_ShipCompany" class="c-form-input c-form-input--large" type="text" name="Customer_ShipCompany" value="&mvte:global:Customer_ShipCompany;" aria-describedby="ShippingInformation Customer_ShipCompany_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipEmail_Row;">
				<label id="Customer_ShipEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipEmail">Email Address</label>
				<input id="Customer_ShipEmail" class="c-form-input c-form-input--large" data-hook="Customer_ShipEmail" type="email" name="Customer_ShipEmail" value="&mvte:global:Customer_ShipEmail;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipEmail_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipPhone_Row;">
				<label id="Customer_ShipPhone_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipPhone">Phone Number</label>
				<input id="Customer_ShipPhone" class="c-form-input c-form-input--large" type="tel" name="Customer_ShipPhone" value="&mvte:global:Customer_ShipPhone;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipPhone_label">
			</div>
			<!--
			Due to the lack of use in most stores, the fax field is commented out.
			If you find that you, or a client, needs the field, remove the HTML comment tags and adjust
			the width class of the email address to u-width-4--m.
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipFax_Row;">
				<label id="Customer_ShipFax_label" class="c-form-label u-font-small u-text-italic" for="Customer_ShipFax">Fax Number</label>
				<input id="Customer_ShipFax" class="c-form-input c-form-input--large" type="tel" name="Customer_ShipFax" value="&mvte:global:Customer_ShipFax;" aria-describedby="ShippingInformation Customer_ShipFax_label">
			</div>
			-->
			<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipAddress1_Row;">
				<label id="Customer_ShipAddress1_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipAddress1">Address</label>
				<input id="Customer_ShipAddress1" class="c-form-input c-form-input--large" type="text" name="Customer_ShipAddress1" value="&mvte:global:Customer_ShipAddress1;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipAddress1_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipAddress2_Row;">
				<label id="Customer_ShipAddress2_label" class="c-form-label u-font-small u-text-italic" for="Customer_ShipAddress2">Address 2</label>
				<input id="Customer_ShipAddress2" class="c-form-input c-form-input--large" type="text" name="Customer_ShipAddress2" value="&mvte:global:Customer_ShipAddress2;" aria-describedby="ShippingInformation Customer_ShipAddress2_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:ShipCity_Row;">
				<label id="Customer_ShipCity_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipCity">City</label>
				<input id="Customer_ShipCity" class="c-form-input c-form-input--large" type="text" name="Customer_ShipCity" value="&mvte:global:Customer_ShipCity;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipCity_label">
			</div>
			
			<mvt:if expr="g.States_Empty">
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipState_Row;">
					<label id="Customer_ShipState_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipState">State/Province</label>
					<input id="Customer_ShipState" class="c-form-input c-form-input--large" type="text" name="Customer_ShipState" value="&mvte:global:Customer_ShipState;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipState_label">
				</div>
			<mvt:else>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipState_Row;">
					<label id="Customer_ShipStateSelect_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipStateSelect">State/Province</label>
					<input name="Customer_ShipState" type="hidden" value="&mvte:global:Customer_ShipState;">
					<input id="Customer_ShipStateSelect" class="c-form-input c-form-input--large" data-datalist list="ShipStateDatalist" name="Customer_ShipStateSelect" placeholder="Select or Type" type="text" value="&mvte:global:Customer_ShipStateSelect;" &mvt:shipping_required; aria-describedby="ShippingInformation Customer_ShipStateSelect_label">
					<datalist id="ShipStateDatalist">
						<mvt:foreach array="global:StateDatalist" iterator="StateData">
							<option value="&mvt:StateData:code;">&mvt:StateData:name;</option>
						</mvt:foreach>
					</datalist>
				</div>
			</mvt:if>
			
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipCountry_Row;" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="Customer_ShipCountry" data-mvt-describedby="ShippingInformation Customer_ShipCountry_label" data-mvt-autocomplete="country">
				<label id="Customer_ShipCountry_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipCountry">Country</label>
				<div class="c-form-select">
					<mvt:item name="countries" param="Customer_ShipCountry" />
				</div>
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:ShipZip_Row;">
				<label id="Customer_ShipZip_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_ShipZip">Zip/Postal Code</label>
				<input id="Customer_ShipZip" class="c-form-input c-form-input--large" type="text" name="Customer_ShipZip" value="&mvte:global:Customer_ShipZip;" aria-describedby="ShippingInformation Customer_ShipZip_label">
			</div>
		</div>
		<hr class="c-keyline">
	</section>
	
	<div class="c-form-list o-layout">
		<div id="BillingInformation" class="c-form-list__item c-form-list__item--full o-layout__item c-heading-echo u-text-bold u-text-uppercase">Billing Information</div>
		<div class="c-form-list__item o-layout__item u-width-12 u-font-small" id="billing_controls">
			<mvt:if expr="g.Action AND g.billing_to_show">
				<label class="c-form-checkbox">
					<input id="billing_to_show" class="c-form-checkbox__input" type="checkbox" name="billing_to_show" value="1" checked>
					<span class="c-form-checkbox__caption u-font-small u-text-uppercase">Billing Information Same as Shipping</span>
				</label>
			<mvt:else>
				<label class="c-form-checkbox">
					<input id="billing_to_show" class="c-form-checkbox__input" type="checkbox" name="billing_to_show" value="1">
					<span class="c-form-checkbox__caption u-font-small u-text-uppercase">Billing Information Same as Shipping</span>
				</label>
			</mvt:if>
		</div>
	</div>
	
	<section id="billing_fields">
		<mvt:if expr="NOT ISNULL l.settings:customer:validated_bill_addresses">
			<input type="hidden" name="Customer_BillValidated" value="1" />
		</mvt:if>
		<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified">
			<div class="c-form-list o-layout o-layout--wide u-text-uppercase">
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillID_Row;">
					<label id="billing_selector_label" class="c-form-label u-font-tiny u-text-bold is-required" for="billing_selector">Saved Address</label>
					<div class="c-form-select">
						<select id="billing_selector" class="c-form-select__dropdown c-form-input--large" name="BillID" aria-describedby="BillingInformation billing_selector_label">
							<mvt:foreach iterator="address" array="customer:addresses">
								<mvt:if expr="toupper( l.settings:address:fname ) EQ toupper( g.BillFirstName ) AND toupper( l.settings:address:lname ) EQ toupper( g.BillLastName ) AND toupper( l.settings:address:email ) EQ toupper( g.BillEmail ) AND toupper( l.settings:address:comp ) EQ toupper( g.BillCompany ) AND toupper( l.settings:address:phone ) EQ toupper( g.BillPhone ) AND toupper( l.settings:address:fax ) EQ toupper( g.BillFax ) AND toupper( l.settings:address:addr1 ) EQ toupper( g.BillAddress1 ) AND toupper( l.settings:address:addr2 ) EQ toupper( g.BillAddress2 ) AND toupper( l.settings:address:city ) EQ toupper( g.BillCity ) AND ( ( ( NOT ISNULL g.BillStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.BillStateSelect ) ) ) OR ( ( ISNULL g.BillStateSelect ) AND ( toupper( l.settings:address:state ) EQ toupper( g.BillState ) ) ) ) AND toupper( l.settings:address:zip ) EQ toupper( g.BillZip ) AND toupper( l.settings:address:cntry ) EQ toupper( g.BillCountry )">
									<option value="&mvte:address:id;" selected>&mvte:address:descrip;</option>
								<mvt:else>
									<option value="&mvte:address:id;">&mvte:address:descrip;</option>
								</mvt:if>
							</mvt:foreach>
							<option value="-1">&lt;New&gt;</option>
						</select>
					</div>
				</div>
			</div>
		</mvt:if>
		<div class="c-form-list o-layout">
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillFirstName_Row;">
				<label id="Customer_BillFirstName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillFirstName">First Name</label>
				<input id="Customer_BillFirstName" class="c-form-input c-form-input--large" type="text" name="Customer_BillFirstName" value="&mvte:global:Customer_BillFirstName;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillFirstName_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillLastName_Row;">
				<label id="Customer_BillLastName_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillLastName">Last Name</label>
				<input id="Customer_BillLastName" class="c-form-input c-form-input--large" type="text" name="Customer_BillLastName" value="&mvte:global:Customer_BillLastName;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillLastName_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillCompany_Row;">
				<label id="Customer_BillCompany_label" class="c-form-label u-font-small u-text-italic" for="Customer_BillCompany">Company (Optional)</label>
				<input id="Customer_BillCompany" class="c-form-input c-form-input--large" type="text" name="Customer_BillCompany" value="&mvte:global:Customer_BillCompany;" aria-describedby="BillingInformation Customer_BillCompany_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillEmail_Row;">
				<label id="Customer_BillEmail_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillEmail">Email Address</label>
				<input id="Customer_BillEmail" class="c-form-input c-form-input--large" data-hook="Customer_BillEmail" type="email" name="Customer_BillEmail" value="&mvte:global:Customer_BillEmail;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillEmail_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillPhone_Row;">
				<label id="Customer_BillPhone_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillPhone">Phone Number</label>
				<input id="Customer_BillPhone" class="c-form-input c-form-input--large" type="tel" name="Customer_BillPhone" value="&mvte:global:Customer_BillPhone;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillPhone_label">
			</div>
			<!--
			Due to the lack of use in most stores, the fax field is commented out.
			If you find that you, or a client, needs the field, remove the HTML comment tags and adjust
			the width class of the email address to u-width-4--m.
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillFax_Row;">
				<label id="Customer_BillFax_label" class="c-form-label u-font-small u-text-italic" for="Customer_BillFax">Fax Number</label>
				<input id="Customer_BillFax" class="c-form-input c-form-input--large" type="tel" name="Customer_BillFax" value="&mvte:global:Customer_BillFax;" aria-describedby="BillingInformation Customer_BillFax_label">
			</div>
			-->
			<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillAddress1_Row;">
				<label id="Customer_BillAddress1_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillAddress1">Address</label>
				<input id="Customer_BillAddress1" class="c-form-input c-form-input--large" type="text" name="Customer_BillAddress1" value="&mvte:global:Customer_BillAddress1;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillAddress1_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillAddress2_Row;">
				<label id="Customer_BillAddress2_label" class="c-form-label u-font-small u-text-italic" for="Customer_BillAddress2">Address 2</label>
				<input id="Customer_BillAddress2" class="c-form-input c-form-input--large" type="text" name="Customer_BillAddress2" value="&mvte:global:Customer_BillAddress2;" aria-describedby="BillingInformation Customer_BillAddress2_label">
			</div>
			<div class="c-form-list__item o-layout__item u-width-8--m &mvte:global:BillCity_Row;">
				<label id="Customer_BillCity_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillCity">City</label>
				<input id="Customer_BillCity" class="c-form-input c-form-input--large" type="text" name="Customer_BillCity" value="&mvte:global:Customer_BillCity;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillCity_label">
			</div>
			
			<mvt:if expr="g.States_Empty">
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillState_Row;">
					<label id="Customer_BillState_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillState">State/Province</label>
					<input id="Customer_BillState" class="c-form-input c-form-input--large" type="text" name="Customer_BillState" value="&mvte:global:Customer_BillState;" &mvt:shipping_required; aria-describedby="BillingInformation Customer_BillState_label">
				</div>
			<mvt:else>
				<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillState_Row;">
					<label id="Customer_BillStateSelect_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillStateSelect">State/Province</label>
					<input name="Customer_BillState" type="hidden" value="&mvte:global:Customer_BillState;">
					<input id="Customer_BillStateSelect" class="c-form-input c-form-input--large" data-datalist list="BillStateDatalist" name="Customer_BillStateSelect" placeholder="Select or Type" type="text" value="&mvte:global:Customer_BillStateSelect;" &mvt:billing_required; aria-describedby="BillingInformation Customer_BillStateSelect_label">
					<datalist id="BillStateDatalist">
						<mvt:foreach array="global:StateDatalist" iterator="StateData">
							<option value="&mvt:StateData:code;">&mvt:StateData:name;</option>
						</mvt:foreach>
					</datalist>
				</div>
			</mvt:if>
			
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillCountry_Row;" data-hook="mvt-select" data-mvt-classlist="c-form-select__dropdown c-form-input--large" data-mvt-id="Customer_BillCountry" data-mvt-describedby="BillingInformation Customer_BillCountry_label" data-mvt-autocomplete="country">
				<label id="Customer_BillCountry_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillCountry">Country</label>
				<div class="c-form-select">
					<mvt:item name="countries" param="Customer_BillCountry" />
				</div>
			</div>
			<div class="c-form-list__item o-layout__item u-width-4--m &mvte:global:BillZip_Row;">
				<label id="Customer_BillZip_label" class="c-form-label u-font-small u-text-bold is-required" for="Customer_BillZip">Zip/Postal Code</label>
				<input id="Customer_BillZip" class="c-form-input c-form-input--large" type="text" name="Customer_BillZip" value="&mvte:global:Customer_BillZip;" aria-describedby="BillingInformation Customer_BillZip_label">
			</div>
		</div>
		<hr class="c-keyline">
	</section>
	
	<mvt:if expr="l.settings:customer:match">
		<mvt:if expr="l.settings:customer:primaddr EQ 'shipping'">
			<script>document.getElementById('billing_to_show').checked = true;</script>
		<mvt:elseif expr="l.settings:customer:primaddr EQ 'billing'">
			<script>document.getElementById('shipping_to_show').checked = true;</script>
		</mvt:if>
	</mvt:if>
	
	<mvt:if expr="g.Basket:cust_id AND g.Customer_Session_Verified AND l.settings:customer:address_count">
		<script>
			var MvCustomerAddresses = [];

			<mvt:foreach iterator="address" array="customer:addresses">
				MvCustomerAddresses[<mvt:eval expr="int( l.settings:address:id )" />] = {
					"id": <mvt:eval expr="int( l.settings:address:id )" />,
					"cust_id": <mvt:eval expr="int( l.settings:address:cust_id )" />,
					"descrip": "&mvtj:address:descrip;",
					"fname": "&mvtj:address:fname;",
					"lname": "&mvtj:address:lname;",
					"email": "&mvtj:address:email;",
					"comp": "&mvtj:address:comp;",
					"phone": "&mvtj:address:phone;",
					"fax": "&mvtj:address:fax;",
					"addr1": "&mvtj:address:addr1;",
					"addr2": "&mvtj:address:addr2;",
					"city": "&mvtj:address:city;",
					"state": "&mvtj:address:state;",
					"zip": "&mvtj:address:zip;",
					"cntry": "&mvtj:address:cntry;",
					"resdntl": <mvt:if expr="l.settings:address:resdntl">true<mvt:else>false</mvt:if>
				};
			</mvt:foreach>
		</script>
	</mvt:if>
	
	<div class="c-form-list u-text-center">
		<div class="c-form-list__item u-inline-block">
			<input class="c-button c-button--full c-button--huge u-font-small u-bg-gray-40 u-text-bold u-text-uppercase" type="submit" value="Save">
		</div>
	</div>
</form>
<script src="&mvte:global:clientside_url;Store_Code=&mvta:store:code;&amp;Filename=ToggleDetails.js&amp;Primaddr=shipping&amp;Shipping=D&amp;Billing=O"></script>
<script>
	(function () {
		'use strict';

		/**
		 * This function is an enhancement to the `datalist` State/Province and Country replacement.
		 * Since a customer can type a value in the input, this will check if the entered value
		 * matches one of the output values or text entries. If so, it passes the value back to
		 * ensure proper functionality with shipping modules, i.e. 2 letter abbreviations for
		 * US and Canada. Otherwise, it the entry is used as typed.
		 * @type {NodeListOf<Element>}
		 */

		let datalist = document.querySelectorAll('[data-datalist]');

		function checkOption(entry, list) {
			let datalist = document.querySelector('#' + list);
			let datalistOptions = datalist.querySelectorAll('option');
			let value = '';

			for (let i = 0; i < datalistOptions.length; i++) {
				let option = datalistOptions[i];

				if (entry.toLowerCase() === option.value.toLowerCase() || entry.toLowerCase() === option.text.toLowerCase()) {
					value = option.value;
				}
			}

			return value;
		}

		if (datalist.length > 0) {
			for (let i = 0; i < datalist.length; i++) {
				let list = datalist[i];

				list.addEventListener('blur', function () {
					let thisDatalist = list.getAttribute('list');
					let checkValue = checkOption(list.value, thisDatalist);

					if (checkValue) {
						list.value = checkValue;
						list.previousElementSibling.value = checkValue;
					}
					else {
						list.previousElementSibling.value = list.value;
					}
				});
			}
		}
	}());
</script>
]]></Template><Mode>customer_edit</Mode><PreventAutomaticTemplateUpdates>Yes</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="ABAL"><Item code="customer"><Template/><Mode>tokens_only_nodisplay</Mode><PreventAutomaticTemplateUpdates>No</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="RGFT"><Item code="customer"><Template/><Mode>tokens_only_nodisplay</Mode><PreventAutomaticTemplateUpdates>No</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="OSEL"><Item code="customer"><Template/><Mode>checkout_display_only</Mode><PreventAutomaticTemplateUpdates>No</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="OPAY"><Item code="customer"><Template><![CDATA[<section class="o-layout u-grids-1 u-grids-3--m t-checkout-customer-summary u-bg-gray-10">
	<div class="o-layout__item">
		<p class="c-heading-echo u-text-uppercase u-text-bold">Shipping Address</p>
		<hr class="c-keyline">
		<p class="u-font-small u-color-gray-40">
			<mvt:if expr="g.Basket:ship_fname OR g.Basket:ship_lname">
				<strong>&mvte:global:Basket:ship_fname; &mvte:global:Basket:ship_lname;</strong><br>
			</mvt:if>
			<span>
				<mvt:if expr="g.Basket:ship_comp">
					&mvte:global:Basket:ship_comp;<br>
				</mvt:if>
				<mvt:if expr="g.Basket:ship_addr1 OR g.Basket:ship_addr2 OR g.Basket:ship_city OR g.Basket:ship_state OR g.Basket:ship_zip OR g.Basket:ship_cntry OR g.Basket:ship_res">
					&mvte:global:Basket:ship_addr1;<br>
					<mvt:if expr="g.Basket:ship_addr2">
						&mvte:global:Basket:ship_addr2;<br>
					</mvt:if>
					<mvt:if expr="(NOT ISNULL g.Basket:ship_city) AND (NOT ISNULL g.Basket:ship_state)">
						&mvte:global:Basket:ship_city;, &mvte:global:Basket:ship_state;	&mvte:global:Basket:ship_zip; &mvte:global:Basket:ship_cntry;
					<mvt:else>
						&mvte:global:Basket:ship_city; &mvte:global:Basket:ship_state;	&mvte:global:Basket:ship_zip; &mvte:global:Basket:ship_cntry;
					</mvt:if>
					<mvt:if expr="g.Basket:ship_res">
						<br>Residential Address
					</mvt:if>
				</mvt:if>
			</span>
			<br>
			<mvt:if expr="g.BasketPaymentGateway EQ 1">
				<a class="u-text-uppercase u-font-tiny u-color-black" href="&mvt:global:secure_sessionurl;Store_Code=&mvta:global:Store_Code;&amp;Action=PAL1&amp;Screen=PAL1&amp;NextScreen=&mvta:global:Screen;&amp;CancelScreen=&mvta:global:Screen;">Edit</a>
			<mvt:else>
				<a class="u-text-uppercase u-font-tiny u-color-black" href="&mvte:urls:OCST:secure;">Edit</a>
			</mvt:if>
		</p>
	</div>
	<div class="o-layout__item">
		<p class="c-heading-echo u-text-uppercase u-text-bold">Shipping Method</p>
		<hr class="c-keyline">
		<p class="u-font-small u-color-gray-40">
			<mvt:foreach iterator="charge" array="basket:charges">
				<mvt:if expr="l.settings:charge:type EQ 'SHIPPING'">
					<mvt:eval expr="glosub(l.settings:charge:descrip, 'Shipping:', '')"/><br>
				</mvt:if>
			</mvt:foreach>
			<a class="u-text-uppercase u-font-tiny u-color-black" href="&mvte:urls:OSEL:secure;">Edit</a>
		</p>
	</div>
	<div class="o-layout__item">
		<p class="c-heading-echo u-text-uppercase u-text-bold">Delivery Notes</p>
		<hr class="c-keyline">
		<p class="u-font-small u-color-gray-40">
			<mvt:if expr="g.order_instructions">
				&mvte:global:order_instructions;<br>
			</mvt:if>
			<a class="u-text-uppercase u-font-tiny u-color-black" href="&mvte:urls:OSEL:secure;">Edit</a>
		</p>
	</div>
</section>
]]></Template><Mode>checkout_display_only</Mode><PreventAutomaticTemplateUpdates>Yes</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="CSBE"><Item code="customer"><Template/><Mode>tokens_only_nodisplay</Mode><PreventAutomaticTemplateUpdates>No</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update><Page_Update code="ACLN"><Item code="customer"><Template/><Mode>tokens_only_nodisplay</Mode><PreventAutomaticTemplateUpdates>No</PreventAutomaticTemplateUpdates><Notes>#Set_Current_Time#</Notes></Item></Page_Update>
